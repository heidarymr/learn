var timeout, elm, hImage, elm_length, elm_index, hold, l1, l2, next, direction, mc, nextTimeOut, loopTimeOut, autoNextTimeOut, audioInterval, currentReadingIndex, remainAudioLoop, currentIndex, win_width = $(window).width(),
    win_height = $(window).height(),
    lang = 2,
    autoPlay = !1,
    tmp = "",
    audioLoop = 0,
    currentTime = 0,
    firstTimeLoaded = 0,
    fontSize = 100,
    path = "/apps-data/verbal-advantage-level-08/",
    lsession = "lastestSession-" + path.split("/")[2],
    lsetting = "settings-" + path.split("/")[2],
    lfontSetting = "fontSize-" + path.split("/")[2];

function succeded(e, t) {
    switch (t) {}
}
var intervalInit, audioTimeout, loadedTime = 0,
    ads = !1,
    countUnitLearned = 0;
$(function() {
    elm = document.getElementById("sound"), $("#modal").css({
        display: "block",
        opacity: "1"
    }), resizeModal(), resizeHomeSection();
    var e = localStorage.getItem(lsetting);
    if (null == e) {
        var t = {
            next: !1,
            loop: 0
        };
        localStorage.setItem(lsetting, JSON.stringify(t))
    }
    var i = localStorage.getItem(lfontSetting);
    if (null == i) {
        var t = {
            fontSize: fontSize
        };
        localStorage.setItem(lfontSetting, JSON.stringify(t))
    } else {
        var s = JSON.parse(localStorage.getItem(lfontSetting));
        fontSize = s.fontSize
    }
    $.ajax({
        url: path + "data/data.json",
        type: "GET",
        dataType: "text",
        success: function(e) {
            var t = $.parseJSON(e),
                s = t.flashcard;
            sessionStorage.clear(), loadedTime = s.length;
            for (var n = ["#0D7F9B", "#82823F", "#D2462A", "#4d2f82", "#0F505B", "#485A90", "#82823F", "#2E3A98", "#985154", "#6c5658", "#2d7d6e"], o = 0, a = 0; a < s.length; a++) {
                var r = s[a].en,
                    l = s[a].desc;
                null == l && (l = "Unit");
                var d = urlFriendlyFull(l.toLowerCase());
                0 == $("#div-" + d).length && ($("#home-section").append("<div id=\"div-" + d + "\"><div class=\"section-cover\" style=\"display:none;font-weight: bold; text-align: left; background:" + n[o] + "\"><div style=\"padding:13px 10px; color:white;\">" + l + "</div></div><ul class=\"curriculum-item\"></ul></div>"), o += 1);
                var c = "waiting",
                    p = localStorage.getItem(path.split("/")[2] + ":" + r.toLowerCase());
                null != p && (!0 == $.parseJSON(p).read ? c = "play" : c = "reading");
                var h = "/apps/" + path.split("/")[2] + "/" + urlFriendlyFull(r.toLowerCase()) + "/#" + a;
                if (null != s[a].wordlist) {
                    var m = s[a].wordlist.length,
                        g = "";
                    h = "/apps/" + path.split("/")[2] + "/" + urlFriendlyFull(r + "-" + g).toLowerCase() + "/#" + a, $("#div-" + d).children("ul").append("<li class=\"item  word-list-session\" story-title=\"" + g + "\"  en=\"" + r + "\" idx=\"" + a + "\" wl=\"" + m + "\"><table id=\"tbl-last-session" + a + "\"><tr><td><div class=\"" + c + "\"></div></td><td><div class=\"title\"><a href=\"" + h + "\">" + r + "</a></div></td></tr></table></li>")
                } else $("#div-" + d).children("ul").append("<li class=\"item  word-list-session\"  story-title=\"\" en=\"" + r + "\" idx=\"" + a + "\" wl=\"0\" ><table id=\"tbl-last-session" + a + "\"><tr><td><div class=\"" + c + "\"></div></td><td><div class=\"title\"><a href=\"" + h + "\">" + r + "</a></div></td></tr></table></li>");
                if (sessionStorage.setItem(path.split("/")[2] + ":" + r, JSON.stringify(s[a])), loadedTime -= 1, a == s.length - 1) {
                    homeSectionResize(), resizeLastSession();
                    var u = window.location.hash.substring(1);
                    if ("" != u) {
                        var f = u.split("&"),
                            v = $("#tbl-last-session" + f[0]).parent();
                        null == v.attr("en") ? showCategorySection("", v.attr("idx"), 0) : showCategorySection(v.attr("en"), v.attr("idx"), 0)
                    } else $("#category-section").css({
                        display: "none"
                    });
                    $("#container").css({
                        opacity: "1"
                    }), $("#modal").animate({
                        opacity: "0"
                    }, 1e3, function() {
                        if ($(".header").css({
                                display: "block"
                            }), $("#modal").remove(), null == $("#page-name").html()) {
                            var e = $("#ads-top").html();
                            $("#ads-top").remove(), $("#article-ads").html(e)
                        }
                    })
                }
            }
            $(".section-cover").bind("click", function() {
                "1" == $(this).attr("opened") ? ($(this).attr("opened", "0"), $(this).parent().children(".curriculum-item").css({
                    display: ""
                })) : ($(this).parent().children(".curriculum-item").css({
                    display: "block"
                }), $(this).attr("opened", "1"))
            }), init()
        }
    }), $(window).resize(function() {
        var e = $("#section-section").find(".title").html();
        switch (resizeModal(), homeSectionResize(), e) {
            case "Index":
                scaleFontSizeIndexToolTips();
                break;
            case "":
                break;
            default:
                scaleFontSize();
        }
        resizeLastSession(), resizeExerciseStory()
    }), $("body").css({
        "font-size": fontSize + "%"
    })
});

function init() {
    loadLastSession(), $("#home-section").attr("top", $("#home-section").attr("top")), $("#home-section").css({
        position: "absolute",
        top: 55
    }), $("#category-section").attr("top", $("#home-section").attr("top")), $("#category-section").css({
        top: 55
    }), $("#section-section").click(function() {
        window.location.href = "/apps/verbal-advantage-level-08/"
    }), $("#settings").click(function() {
        settings($("#settings").attr("itemid"))
    }), loadSettings(), $(".font-size").bind("click", function() {
        $(this).css({
            "border-radius": "0px"
        }), $(".font-size-cover,#setting-container").css({
            display: "block"
        }), $(".font-size-cover>button").unbind("click"), $(".font-size-cover>button").bind("click", function() {
            var e = $(this).index();
            0 === e ? fontSize -= 10 : 1 === e ? fontSize = 100 : 2 === e ? fontSize += 10 : void 0;
            $("body").css({
                "font-size": fontSize + "%"
            });
            var t = {
                fontSize: fontSize
            };
            localStorage.setItem(lfontSetting, JSON.stringify(t))
        })
    }), $(document).on("click", function(t) {
        0 === $(t.target).closest(".font-size").length && ($(".font-size").css({
            "border-radius": ""
        }), $(".font-size-cover,#setting-container").hide())
    }), $(document).on("touchstart", function(t) {
        0 === $(t.target).closest(".font-size").length && ($(".font-size").css({
            "border-radius": ""
        }), $(".font-size-cover,#setting-container").hide())
    }), homeSectionResize(), homeScroll("")
}

function panLeft() {
    !1 == hold && (direction = "left", next = elm_index + 1, next == elm_length ? next = 0 : $("#item" + (elm_index + 1)).css({
        left: $(window).width()
    }), elm_length == elm_index + 1 && $("#item0").css({
        left: $(window).width()
    }), hold = !0), l1 = $("#item" + elm_index).offset().left, l2 = $("#item" + next).offset().left, $("#item" + elm_index).animate({
        left: l1 - 1
    }, 0, function() {}), $("#item" + next).animate({
        left: parseInt(l2) - 1
    }, 0, function() {})
}

function panRight() {
    !1 == hold && (direction = "right", next = elm_index - 1, 0 > next ? next = elm_length - 1 : $("#item" + (elm_index - 1)).css({
        left: -$(window).width()
    }), 0 == next && $("#item" + (elm_length - 1)).css({
        left: -$(window).width()
    }), hold = !0), l1 = $("#item" + elm_index).offset().left, l2 = $("#item" + next).offset().left, $("#item" + elm_index).animate({
        left: parseInt(l1) + 1
    }, 0, function() {}), $("#item" + next).animate({
        left: parseInt(l2) + 1
    }, 0, function() {})
}

function panEnd(e) {
    "left" == direction ? 100 < e ? ($("#item" + elm_index).animate({
        left: -$(window).width()
    }, 400, function() {}), 1 == $("#item" + next).attr("story") || 1 == $("#item" + next).attr("exercise") ? $("#item" + next).animate({
        left: 0
    }, 400, function() {
        playSound(next, $("#item" + next).attr("source")), focusReading(next)
    }) : $("#item" + next).animate({
        left: 10
    }, 400, function() {
        playSound(next, $("#item" + next).attr("source")), focusReading(next)
    }), elm_index = next) : ($("#item" + elm_index).animate({
        left: 10
    }, 400, function() {}), $("#item" + next).animate({
        left: $(window).width()
    }, 400, function() {}), nextWordReading()) : 100 < e ? ($("#item" + elm_index).animate({
        left: $(window).width()
    }, 400, function() {}), 1 == $("#item" + next).attr("story") || 1 == $("#item" + next).attr("exercise") ? $("#item" + next).animate({
        left: 0
    }, 400, function() {
        playSound(next, $("#item" + next).attr("source")), focusReading(next)
    }) : $("#item" + next).animate({
        left: 10
    }, 400, function() {
        playSound(next, $("#item" + next).attr("source")), focusReading(next)
    }), elm_index = next) : ($("#item" + elm_index).animate({
        left: 10
    }, 300, function() {}), $("#item" + next).animate({
        left: -$(window).width()
    }, 400, function() {}), nextWordReading()), hold = !1
}

function loadSettings() {
    if ($("#setting-container").remove(), 0 == $("#setting-container").length) {
        var e = "<table>";
        e += "<tr><td>Auto next</td><td><label class=\"switch\"><input id=\"chkAuto\" type=\"checkbox\"><div class=\"slider round\"></div></label></td></tr>", e += "<tr><td>Number of repeat</td><td><select id=\"optLoop\"><option value=\"0\">0</option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option><option value=\"4\">4</option><option value=\"5\">5</option></select></td></tr>", e += "</table>", $(".font-size").append("<div id=\"setting-container\"><div>" + e + "</div></div>"), $("#setting-container").children("div").css({
            padding: 10
        }), $("#chkAuto, #optLoop").change(function() {
            var e = $("#chkAuto").prop("checked"),
                t = {
                    next: e,
                    loop: $("#optLoop").val()
                };
            localStorage.setItem(lsetting, JSON.stringify(t))
        })
    }
    var t = JSON.parse(localStorage.getItem(lsetting));
    $("#optLoop").val(t.loop), !0 == t.next ? $("#chkAuto").attr("checked", "checked") : $("#chkAuto").removeAttr("checked")
}

function settings(e) {
    if ($("#setting-container").remove(), 1 == e) {
        if ($("#settings img").attr("src", "/apps-data/icons/close-window-50.png"), 0 == $("#setting-container").length) {
            var t = "<table>";
            t += "<tr><td>Auto next words</td><td><label class=\"switch\"><input id=\"chkAuto\" type=\"checkbox\"><div class=\"slider round\"></div></label></td></tr>", t += "<tr><td>Number of repeat</td><td><select id=\"optLoop\"><option value=\"0\">0</option><option value=\"1\">1</option><option value=\"2\">2</option><option value=\"3\">3</option><option value=\"4\">4</option><option value=\"5\">5</option></select></td></tr>", t += "</table>", $("body").append("<div id=\"setting-container\"><div>" + t + "</div></div>"), $("#setting-container").css({
                height: $(window).height(),
                width: 250,
                right: -300
            }), $("#setting-container").children("div").css({
                padding: 20
            }), $("#chkAuto, #optLoop").change(function() {
                var e = $("#chkAuto").prop("checked"),
                    t = {
                        next: e,
                        loop: $("#optLoop").val()
                    };
                localStorage.setItem(lsetting, JSON.stringify(t))
            })
        }
        var i = JSON.parse(localStorage.getItem(lsetting));
        $("#optLoop").val(i.loop), !0 == i.next ? $("#chkAuto").attr("checked", "checked") : $("#chkAuto").removeAttr("checked"), $("#settings").attr("itemid", 0), $("#setting-container").animate({
            right: 0
        }, function() {})
    } else $("#settings img").attr("src", "/apps-data/icons/Settings-50.png"), $("#setting-container").animate({
        right: -300
    }, function() {}), $("#settings").attr("itemid", 1)
}

function resize() {
    1 == $("#show-menu").attr("itemid") ? $(".header").animate({
        left: $(window).width() - 60
    }, 0, function() {
        $(".header").css({
            position: "fixed"
        })
    }) : $(".header").css({
        width: "100%",
        left: 0
    });
    var e = $(window).width();
    $("#container").css({
        width: e
    }), 500 < e - 320 ? ($("#category-section, #home-section").css({
        width: "calc(100% - 320px)",
        position: ""
    }), $("#right-banner").css({
        "z-index": "1",
        "vertical-align": "top",
        top: 55,
        width: 300,
        position: ""
    }), $("#right-banner").children("div").css({
        padding: "0px",
        bottom: "",
        position: "fixed",
        width: 300
    }), $(window).scroll(function() {
        parseInt($(this).scrollTop());
        $(window).scrollTop() >= $(document).height() - 60 - $(window).height() - $("#right-banner").innerHeight() ? $("#right-banner div").eq(0).css({
            bottom: 60,
            top: ""
        }) : $("#right-banner div").eq(0).css({
            bottom: ""
        })
    })) : ($("#category-section, #home-section").css({
        width: "100%",
        position: "relative"
    }), $("#right-banner").css({
        top: 10,
        width: "100%",
        position: "relative"
    }), $("#right-banner").children("div").css({
        padding: "0px",
        bottom: "",
        position: "",
        width: "100%",
        "margin-bottom": 55
    }))
}

function resizeHomeSection() {
    var e = $(window).height() - $(".header").height() - $("#bottom-section").height(),
        t = $(".header").css("height"),
        i = $("#home-section");
    resize()
}

function showCategorySection(e, t, i) {
    if (firstTimeLoaded = 1, setStoreLastSession(e, t), settings(0), $("#bottom-section").css({
            display: "none"
        }), $("#category-section").attr("top", $("#home-section").attr("top")), $("#home-detail").animate({
            opacity: "0"
        }, 0, function() {
            $("#home-detail").css({
                display: "none"
            })
        }), $("#section-section").css({
            display: "block",
            opacity: "0",
            left: $(window).width()
        }), $("#section-section").animate({
            opacity: "1",
            left: 0
        }, 500, function() {}), "index" != e.toLowerCase()) {
        var s = JSON.parse(sessionStorage.getItem(path.split("/")[2] + ":" + e));
        null == s ? $("#section-section").children(".title").html(e) : $("#section-section").children(".title").html(e)
    } else $("#section-section").children(".title").html(e);
    $("#home-section").animate({
        opacity: "0"
    }, 0, function() {}), $("#category-section").animate({
        opacity: "1"
    }, 500, function() {
        $("#category-section").find(".section-more").css({
            display: "block"
        }), $("#home-section").css({
            display: "none"
        })
    });
    var n = JSON.parse(localStorage.getItem(lsetting));
    audioLoop = n.loop, currentReadingIndex = i, getSectionItem(e), countUnitLearned += 1
}

function getSectionItem(e) {
    if (null != sessionStorage[path.split("/")[2] + ":" + e]) {
        var t = JSON.parse(localStorage.getItem(lsetting));
        remainAudioLoop = null != t && 0 < t.loop ? t.loop : 0;
        var s = localStorage.getItem(e.toLowerCase());
        if (null == s) {
            localStorage.setItem(path.split("/")[2] + ":" + e.toLowerCase(), JSON.stringify({
                read: !1
            })), $("#tbl-last-session" + currentIndex).find("div").eq(0).attr("class", "reading")
        }
        $("#category-section").children(".section").children(".container").html("");
        var n = JSON.parse(sessionStorage.getItem(path.split("/")[2] + ":" + e)).wordlist;
        if (n != null || null != n) {
            $("#category-section").children(".section").children(".container").append("<div id=\"idioms-block\" class=\"box_shadow_yt_iframe seg-block\"><div class=\"wordlist-rotate\">Word List</div><ul class=\"wordlist\"></ul></div>");
            for (var o = 0; o < n.length; o++) {
                var a = n[o].en,
                    r = n[o].en.substring(0, 1),
                    l = r.toUpperCase() + a.substring(1, a.length),
                    d = n[o].vi,
                    c = n[o].pron,
                    p = n[o].desc,
                    h = n[o].exam,
                    m = n[o].image,
                    g = n[o].sound,
                    u = "<li remainAudioLoop=\"" + remainAudioLoop + "\" id=\"item" + o + "\">";
                u += "<div class=\"wordlist-cover\">", u += "<div class=\"en-word\">" + a + " <span class=\"en-pron\">" + c + "</span> <img class=\"wordlist-sound speaker-louder\" idx=\"" + o + "\" source=\"" + path + "data/" + urlFriendly(e) + "/wordlist/" + g + "\" title=\"" + a + "\" src=\"/apps-data/icons/speaker_louder.png\" /></div>", u += "<div class=\"en-desc\">" + p.replace(a, "<strong>" + a + "</strong>").replace(l, "<strong>" + l + "</strong>") + "</div>", u += "<div class=\"en-exam\">" + h + "</div>", u += "</div>", u += "</li>", $("#idioms-block").find(".wordlist").append(u), $("#item" + o).attr("source", path + "data/" + urlFriendlyFull(e) + "/wordlist/" + g + ""), $("#item" + o).attr("title", a), $("#item" + o).attr("nid", o + 1)
            }
        } else readFlag();
        var f = JSON.parse(sessionStorage.getItem(path.split("/")[2] + ":" + e)).exercise;
        if (null != f)
            if ($("#category-section").children(".section").children(".container").append("<div id=\"exercise-block\" class=\"box_shadow_yt_iframe seg-block\"></div>"), "index" == e.toLowerCase()) {
                for (var o = 0; 1 > o; o++) {
                    var a = f[o].en,
                        v = f[o].story;
                    if (0 == o) {
                        var u = "<div>";
                        u += "<div class=\"en-story\"><div class=\"faq-list-section\"><h2 style=\"margin-top:0px\">" + a.toUpperCase() + "</h2>" + v + "</div></div>", u += "</div>", $("#exercise-block").append(u)
                    }
                }
                setTimeout(function() {
                    for (var e = 1; e < f.length; e++) {
                        var t = f[e].en,
                            s = f[e].story;
                        $("#exercise-block").append("<div class=\"faq-list-section\"><h2>" + t.toUpperCase() + "</h2>" + s + "</div></div>")
                    }
                    $(".index-block-item li").click(function() {
                        var e = $(this).children(".tool-index-idioms").html();
                        $(this).html("<div class=\"tool-index-idioms\">" + e + "</div>"), $(this).css({
                            display: "contents",
                            margin: "20px 0px 20px 0px"
                        }), $(this).children(".tool-index-idioms").attr("style", "display: table-cell;background:antiquewhite; padding:10px; border-radius:5px; color:black"), scaleFontSize()
                    })
                }, 200)
            } else
                for (var o = 0; o < f.length; o++) {
                    var a = f[o].en,
                        v = f[o].story,
                        g = f[o].sound;
                    "Answer Key" == a ? $("#exercise-block").append("<div id=\"exercise-answer-key\"><div class=\"exercise-section\">" + a + "</div><div class=\"faq-list-section\" title=\"" + a + "\">" + v + "</div></div></div>") : "" == g ? $("#exercise-block").append("<div class=\"voca-block-title\">" + a + " </div><div class=\"faq-list-section\" title=\"" + a + "\">" + v + "</div></div>") : ($("#exercise-block").append("<div class=\"voca-block-title\" style=\"display:flex\">" + a + " <img title=\"" + a + "\" source=\"" + path + "data/" + urlFriendly(e) + "/exercise/" + g + "\" class=\"speaker-louder\" style=\"width:20px; margin-left: 10px\" src=\"/apps-data/icons/speaker_louder.png\" /></div><div class=\"faq-list-section\" title=\"" + a + "\">" + v + "</div></div>"), null == n && ($(".voca-block-title").css({
                        "margin-bottom": "10px"
                    }), $(".voca-block-title").children(".speaker-louder").css({
                        display: "none"
                    }), $("#sound").attr("src", `${path}data/${urlFriendly(e)}/exercise/${g}`), $("#nav-story li").eq(0).css({
                        display: "none"
                    }), $("#nav-story li").eq(1).css({
                        display: "none"
                    }), $("#nav-story li").eq(2).css({
                        width: "100%"
                    }))), o == f.length - 1 && ("Answer Key" == a ? ($("#exercise-block").append("<div class=\"exercise-section-red-answer-key\">Answer Key</div><p style=\"display:none\" class=\"answer-key-remove-after\">&nbsp;</p>"), $(".exercise-section-red-answer-key").click(function() {
                        elm.pause(), autoPlay = !1, $("#nav-story").children("li").eq(0).children("img").attr("status", 0), $("#nav-story").children("li").eq(0).children("img").attr("src", "/apps-data/icons/play.png"), $(".answer-key-remove-after").remove(), $("#exercise-answer-key, .exercise-section-answered").css({
                            display: "block"
                        }), $(".exercise-section-red-answer-key").css({
                            display: "none"
                        });
                        for (var e = 0; e < $(".answer-the-questions-section").length; e++) 0 == $(".answer-the-questions-section").eq(e).children(".answer-voice").length && $(".answer-the-questions-section").eq(e).append("<div class=\"answer-voice answer-voice-wrong\">" + $(".answer-key").eq(e).html() + "</div>");
                        $(".answer-voice").each(function() {
                            $(this).css({
                                display: "block"
                            })
                        })
                    })) : $("#exercise-block").append("<p style=\"display:none\" class=\"answer-key-remove-after\">&nbsp;</p>"))
                }
        replaceChooseAnswer(), $(".counter").each(function() {
            $(this).css({
                "margin-left": ($(window).width() - $(this).width() - 20) / 2
            })
        }), $(".speaker-louder").click(function() {
            var e = $(this).attr("source");
            currentReadingIndex = $(this).attr("idx"), playSound(currentReadingIndex, e), $("#nav-story li").eq(0).children("span").html($(this).attr("title"))
        }), homeSectionResize(), scaleFontSize(), playSeeking(0);
        var w = window.location.hash.substring(1);
        if ("" != w) {
            var y = w.split("&");
            if (1 < y.length) switch (y[1].toLowerCase()) {
                case "word list":
                    $(window).scrollTop($("#idioms-block").offset().top - 60);
                    break;
                case "story":
                    $(window).scrollTop($("#story-block").offset().top - 60);
                    break;
                case "exercise":
                    $(window).scrollTop($("#exercise-block").offset().top - 60);
            }
        }
    }
}

function playSeeking(e) {
    $("#category-section").find(".container").children("li").each(function() {
        $(this).css({
            width: "100%"
        })
    }), elm_length = $("#category-section").find(".container").children("li").length;
    for (var t = 0; t < elm_length; t++);
    currentReadingIndex = e, elm_index = e, hold = !1, next = 0, setTimeout(function() {
        playSound(currentReadingIndex, $("#item" + currentReadingIndex).attr("source")), focusReading(currentReadingIndex)
    }, 1e3)
}

function playSound(t, e) {
    clearInterval(audioInterval), currentReadingIndex = t;
    $("#bottom-section").css({
        display: "block"
    });
    var i = JSON.parse(localStorage.getItem(lsession)),
        s = $("#tbl-last-session" + (parseInt(i.index) + 1)),
        n = s.parent().attr("en");
    "" != s.parent().attr("story-title") && (n += ": " + s.parent().attr("story-title")), 0 < s.length ? (0 == $("#nav-story").length && ($("#bottom-section").children(".container").html("<ul id=\"nav-story\"><li source=\"" + e + "\"><img class=\"audio-play\" status=\"0\" src=\"/apps-data/icons/play.png\" /><span style=\"margin-left:5px; position:relative; top:-23px\"></span></li><li>Exercise</li><li><a style=\"color:yellow\" href=\"/apps/" + path.split("/")[2] + "/" + urlFriendlyFull(n) + "/#" + (parseInt(i.index) + 1) + "\">" + n + "</a></li></ul>"), $("#nav-story").children("li").eq(0).click(function() {
        1 == $("#nav-story").children("li").eq(0).children("img").attr("status") ? ($("#nav-story").children("li").eq(0).children("img").attr("status", 0), $("#nav-story").children("li").eq(0).children("img").attr("src", "/apps-data/icons/play.png"), elm.pause()) : ($("#nav-story").children("li").eq(0).children("img").attr("status", 1), $("#nav-story").children("li").eq(0).children("img").attr("src", "/apps-data/icons/pause.png"), elm.play())
    }), $("#nav-story").children("li").eq(1).click(function() {
        switch ($(this).html()) {
            case "Word List":
                $(window).scrollTop($("#idioms-block").offset().top - 60);
                break;
            case "Story":
                $(window).scrollTop($("#story-block").offset().top - 60);
                break;
            case "Exercise":
                $(window).scrollTop($("#exercise-block").offset().top - 60);
        }
    }), $("#sound").attr("src") == null ? 0 == $(".wordlist").length && ($("#nav-story li").eq(0).css({
        display: "none"
    }), $("#nav-story li").eq(1).css({
        display: "none"
    }), $("#nav-story li").eq(2).css({
        width: "100%"
    })) : ($("#nav-story li").eq(0).css({
        width: "50%"
    }), $("#nav-story li").eq(1).css({
        display: "none"
    }), $("#nav-story li").eq(2).css({
        width: "50%"
    }))), !1 == autoPlay ? ($("#nav-story").children("li").eq(0).children("img").attr("status", "0"), $("#nav-story").children("li").eq(0).children("img").attr("src", "/apps-data/icons/play.png")) : ($("#nav-story").children("li").eq(0).children("img").attr("status", "1"), $("#nav-story").children("li").eq(0).children("img").attr("src", "/apps-data/icons/pause.png")), "" == $("#nav-story li").eq(0).children("span").html() && $("#nav-story li").eq(0).children("span").html($(".speaker-louder").eq(0).attr("title"))) : $("#bottom-section").children(".container").html("<div class=\"app-name\">Verbal Advantage</div><div class=\"app-slogan\">Level 08</div>"), e != null && (elm.src = e, elm.onloadedmetadata = function() {
        localStorage.setItem("currentIndex", currentReadingIndex), $("#player-loading").remove(), !0 == autoPlay ? elm.play() : autoPlay = !0
    }, elm.onended = function() {
        if ($("#nav-story").children("li").eq(0).children("img").attr("status", 0), $("#nav-story").children("li").eq(0).children("img").attr("src", "/apps-data/icons/play.png"), !0 == isStory()) readFlag();
        else {
            var e = parseInt($("#item" + currentReadingIndex).attr("remainAudioLoop"));
            0 < e ? loopTimeOut = setTimeout(function() {
                $("#item" + currentReadingIndex).attr("remainAudioLoop", e - 1), playSound(currentReadingIndex, $("#item" + currentReadingIndex).attr("source")), clearTimeout(nextTimeOut), clearTimeout(loopTimeOut), clearTimeout(autoNextTimeOut)
            }, 2e3) : (clearTimeout(nextTimeOut), clearTimeout(loopTimeOut), clearTimeout(autoNextTimeOut), autoNextTimeOut = setTimeout(function() {
                $("#item" + t).find(".reading").click(function() {
                    clearTimeout(nextTimeOut), clearTimeout(loopTimeOut), clearTimeout(autoNextTimeOut), playSound(t, $(this).parent().parent().attr("source"))
                }), $("#item" + currentReadingIndex).attr("remainAudioLoop", remainAudioLoop), nextWordReading()
            }, 200))
        }
    }), resizeExerciseStory()
}

function readFlag() {
    var e = JSON.parse(localStorage.getItem(lsession)),
        t = $("#tbl-last-session" + e.index).parent().attr("en");
    localStorage.removeItem(path.split("/")[2] + ":" + t.toLowerCase());
    var i = localStorage.getItem(path.split("/")[2] + ":" + t.toLowerCase());
    if (null == i) {
        localStorage.setItem(path.split("/")[2] + ":" + t.toLowerCase(), JSON.stringify({
            read: !0
        }))
    }
    $("#tbl-last-session" + currentIndex).find("div").eq(0).attr("class", "play")
}

function nextWordReading() {
    var e = JSON.parse(localStorage.getItem(lsetting));
    null != e && !0 == e.next && (nextTimeOut = setTimeout(function() {
        $("#item" + currentReadingIndex).attr("nid") != null && (currentReadingIndex = $("#item" + currentReadingIndex).attr("nid"), $("html, body").animate({
            scrollTop: $("#item" + currentReadingIndex).offset().top - 60
        }, {
            complete: function() {
                $("#nav-story li").eq(0).children("span").html($("#item" + currentReadingIndex).attr("title")), playSound(currentReadingIndex, $("#item" + currentReadingIndex).attr("source"))
            }
        }))
    }, 3e3))
}

function focusReading(e) {
    if (0 == $("#item" + e).find(".word-image").find(".reading").length) {
        $("#item" + next).find(".word-image").append("<div class='reading' style='position:absolute;'></div>");
        var t = $(window).width();
        $("#item" + e).find(".word-image").find(".reading").css({
            width: (t - 20) / 2,
            height: "100%",
            top: 0,
            left: (t - (t - 20) / 2) / 2 - 10
        })
    }
}

function homeScroll() {
    $(window).scroll(function() {
        var e = parseInt($("#home-section").height()),
            t = $("#home-section").offset(),
            i = $(window).height(),
            s = parseInt($(this).scrollTop());
        if ($("#home-section").attr("top", s), 0 != $("#exercise-block").length) {
            var n = $("#exercise-block").position().top;
            $("#home-section").attr("vb", n - parseInt($(window).height()) - 150);
            var o = 0;
            0 < $("#story-block").length && (o = $("#story-block").position().top), s >= n - parseInt($(window).height()) + 150 && $("#bottom-section").find("#nav-story").children("li").eq(1).html("Story"), s >= o - parseInt($(window).height()) + 150 && $("#bottom-section").find("#nav-story").children("li").eq(1).html("Word List"), s < n - parseInt($(window).height()) + 150 && $("#bottom-section").find("#nav-story").children("li").eq(1).html("Exercise")
        }
    }), $("#home-section").scroll(function() {
        var e = parseInt($("#home-section").height()),
            t = $("#home-section").offset(),
            i = $(window).height(),
            s = parseInt($(this).scrollTop());
        $("#home-section").attr("top", s)
    })
}

function homeSectionResize() {
    var e = $(window).width() - 20;
    isMobile.any() || (e -= 18);
    var t = 320,
        i = Math.floor(e / t);
    0 == i && (i = 1);
    var s;
    s = 2 < i ? 10 * (2 * (i - 1)) : 10 * i, 1 == i && (s = 0), t = Math.floor((e - s) / i), $("#home-section").children("ul").children("li").each(function() {
        $(this).css({
            clear: ""
        })
    }), $("#home-section").children("ul").children("li").each(function() {
        0 < $(this).index() & 0 == $(this).index() % i && $(this).css({
            clear: "both"
        }), $(this).eq(i).css({
            clear: "both"
        }), $(this).css({
            width: t
        }), $(this).find("img").css({
            width: t
        })
    }), $(window).width() <= $(window).height() ? $(".counter").parent().css({
        "padding-top": 20
    }) : $(".counter").parent().css({
        "padding-top": 30
    }), resizeHomeSection(), resizeUnitItem()
}

function scaleFontSize() {
    $(".en-word").each(function() {
        var e = $(window).width() * $(window).height(),
            t = Math.sqrt(e) / Math.sqrt(786432)
    }), $(".alphabet").each(function() {
        var e = $(window).width() * $(window).height(),
            t = Math.sqrt(e) / Math.sqrt(786432);
        $(".alphabet").css("font-size", 300 * t + "%")
    }), $(".en-story-title").each(function() {
        var e = $(window).width() * $(window).height(),
            t = Math.sqrt(e) / Math.sqrt(786432),
            i = 150 * t;
        120 > i && (i = 120)
    }), resizeWordImage(), resizeUsageTipsSeg()
}

function resizeWordImage() {
    $(".word-image").find("img").each(function() {
        hImage = $(window).height() - $(".en-word").height() - $(".vn-word").height() - $(".alphabet").height() - $("#bottom-section").height() - 230, $(this).css({
            margin: "10px 0px 10px 0px"
        }), 300 <= hImage && (hImage = 300), 120 >= hImage && (hImage = 120), $(this).css({
            height: hImage,
            width: hImage
        }), 1 == parseInt($(this).attr("story")) && ($(this).css({
            "margin-top": "0px"
        }), 220 <= hImage && $(this).css({
            height: 220,
            width: 220
        }), 120 >= hImage && $(this).css({
            height: 120,
            width: 120
        }), $(this).parent().css({
            float: "",
            "padding-right": ""
        }), 600 > $(window).width() && $(this).parent().css({
            float: "none",
            "padding-right": "initial"
        }))
    }), $(".wordlist-image").find("img").each(function() {
        $(this).css({
            margin: "8px 0px 0px 0px"
        }), $(this).css({
            height: "",
            width: ""
        });
        var e = 120;
        400 > $(window).width() && (e = 90), $(this).css({
            height: e,
            width: e
        }), $(this).parent().parent().find(".wordlist-cover").css({
            "max-width": $("#category-section").width() - ($(this).width() + 70)
        })
    })
}

function swipeWindow() {
    $("#category-section").find(".container").children("li").each(function() {
        $(this).css({
            width: "100%"
        })
    }), elm_length = $("#category-section").find(".container").children("li").length;
    for (var e = 0; e < elm_length; e++);
    1 != $("#item" + currentReadingIndex).attr("story") && 1 != $("#item" + currentReadingIndex).attr("exercise")
}

function isStory() {
    var e = parseInt($("#item" + currentReadingIndex).attr("story"));
    return !(1 != e)
}

function isExercise() {
    var e = parseInt($("#item" + currentReadingIndex).attr("exercise"));
    return !(1 != e)
}

function resizeExerciseStory() {
    $("#category-section").find(".container").children("li").each(function() {
        if (1 == $(this).attr("story") || 1 == $(this).attr("exercise")) {
            var e = $("#item" + $(this).index()).children("div");
            e.css({
                height: "",
                width: "",
                "overflow-y": "",
                "overflow-x": ""
            });
            var t = $(window).height() - $(".header").height() - $("#bottom-section").height();
            e.height() > t, $("#item" + $(this).index()).find(".faq-list-section").children("ol").css({
                margin: "",
                padding: ""
            }), $("#item" + $(this).index()).find(".faq-list-section").css({
                "padding-bottom": 10
            }), 400 > $(window).width() && $("#item" + $(this).index()).find(".faq-list-section").children("ol").css({
                margin: "0px",
                padding: "0px 0px 0px 20px"
            })
        }
    }), $("#nav-story li").each(function() {
        $(this).children("img").css({
            float: "",
            "margin-left": ""
        }), $(this).children("span").attr("style", "margin-left:5px; position:relative; top:-23px"), $(this).width() < $(this).children("span").width() + 45 && ($(this).children("img").css({
            float: "left",
            "margin-left": 5
        }), $(this).children("span").attr("style", "margin-left:5px;"))
    }), $(".story-image").attr("style", ""), $(".h3-en-story-title,.story-image img").attr("style", ""), 500 > $(window).width() && ($(".story-image").attr("style", "float: none;padding-right: 0px;"), $(".h3-en-story-title").attr("style", "text-align:center"), $(".story-image img").attr("style", "width: 160px")), resizeTextareaAnswer()
}

function resizeStory() {
    $("#category-section").find(".container").children("li").each(function() {
        if (1 == $(this).attr("story") || 1 == $(this).attr("exercise")) {
            var e = $("#item" + $(this).index()).children("div");
            e.css({
                height: "",
                width: ""
            });
            var t = $(window).height() - $(".header").height() - $("#bottom-section").height();
            e.height() > t, $("#item" + $(this).index()).find(".faq-list-section").children("ol").css({
                margin: "",
                padding: ""
            }), 400 > $(window).width() && $("#item" + $(this).index()).find(".faq-list-section").children("ol").css({
                margin: "0px",
                padding: "0px 0px 0px 20px"
            })
        }
    })
}

function resizeUsageTipsSeg() {
    $(".en-exam").each(function() {
        $(this).css({
            "padding-top": 10
        }), $(this).children("div").css({
            width: "",
            float: ""
        }), $(this).children("div").css({
            "font-size": "100%",
            "font-style": "normal",
            display: "inline-block",
            float: "left",
            "text-align": "left",
            "margin-top": 10
        }), $(this).children("div").children("div").eq(1).css({
            "padding-top": 10
        }), $(this).children("div").width() >= $(window).width() ? $(this).children("div").css({
            float: ""
        }) : 0 == $(this).children("div").width() ? $(this).children("div").css({
            width: "",
            float: ""
        }) : $(this).children("div").css({
            width: "",
            float: ""
        })
    }), $(".toefl-prep-para").each(function() {
        $(this).parent().css({
            "font-weight": "normal"
        })
    })
}

function setStoreLastSession(e, t) {
    var i = {
        title: e,
        image: $("#home-section").children("ul").children("li").eq(t).find("img").attr("src"),
        index: t,
        windex: 0,
        eindex: 0,
        sindex: 0
    };
    localStorage.setItem(lsession, JSON.stringify(i))
}

function loadLastSession() {
    try {
        var e = JSON.parse(localStorage.getItem(lsession));
        if (null != e) {
            var t = "waiting",
                i = localStorage.getItem(path.split("/")[2] + ":" + e.title.toLowerCase());
            null != i && (!0 == $.parseJSON(i).read ? t = "play" : t = "reading"), $("#tbl-last-session" + e.index).parent().parent().parent().children(".section-cover").attr("opened", "1"), $("#tbl-last-session" + e.index).parent().parent().css({
                display: "block"
            }), $("#tbl-last-session" + e.index).find("td").eq(0).children("div").attr("class", t), 0 < $("#tbl-last-session" + e.index).find("td").eq(1).find(".your-answer").length && $("#tbl-last-session" + e.index).find("td").eq(1).find(".your-answer").remove(), $("#tbl-last-session" + e.index).find("td").eq(1).children(".title").append(loadAnswerKey(e.title)), "Index" != e.title && $("#home-section").children("#last-session-segment").html("<ul class=\"curriculum-item\" style=\"background:#1DA362\"><li class=\"item\" id=\"word-list-session\" style=\"color:white\"><table><tr><td><div class=\"" + t + "\"></div></td><td><div class=\"title\">" + e.title + loadAnswerKey(e.title) + " </div></td></tr></table></li></ul>"), $("#home-section").children("div").eq(0).css({
                "padding-top": 15,
                "padding-bottom": 0
            }), $("#word-list-session, #img-last-session-unit").click(function() {
                showCategorySection(e.title, e.index, 0)
            }), $("#exercise-lastest-session").click(function() {
                var e = JSON.parse(localStorage.getItem(lsession));
                showCategorySection(e.title, e.index, e.eindex)
            }), $("#story-lastest-session, #story-lastest-session-play-button").click(function() {
                var e = JSON.parse(localStorage.getItem(lsession));
                showCategorySection(e.title, e.index, e.sindex)
            }), resizeLastSession(), resizeUnitItem()
        } else $("#tbl-last-session0").parent().parent().parent().attr("opened", "1"), $("#tbl-last-session0").parent().parent().css({
            display: "block"
        })
    } catch (e) {}
}

function resizeLastSession() {
    var e = $(window).width() - 130 - 40;
    130 < e && (e = 130), $("#img-last-session-unit").css({
        width: e
    })
}

function resizeUnitItem() {
    var e = $("#home-section").children("ul").children("li").eq(0).width() - 130 - 20;
    130 < e && (e = 130), $(".img-last-session-unit").css({
        width: e
    }), $(".session-play-button").css({
        width: 39,
        "border-radius": "50px",
        border: "0px",
        position: "absolute",
        top: (e - 39) / 2,
        left: (e - 39) / 2
    })
}

function resizeModal() {
    var e = 320,
        t = 320;
    isMobile.any() ? (e = 200, t = e) : $(window).width() < e && (e = $(window).width() - 40, t = e)
}

function replaceChooseAnswer() {
    $(".answer-the-questions-section .ul-choose-answer").children("li").each(function() {
        var e = $(this).html();
        $(this).html("<input type=\"radio\" name=\"rdo" + $(this).parent().parent().parent().parent().index() + $(this).parent().parent().index() + $(this).parent().index() + "\" /> " + e)
    }), $(".answer-the-questions-section .ul-choose-answer").children("li").click(function() {
        $(this).parent().children("li").each(function() {
            $(this).css({
                color: "",
                "font-weight": ""
            })
        }), $(this).find("input").attr("checked", "checked"), $(this).find("input").prop("checked", !0), $(this).css({
            color: "gray",
            "font-style": "italic"
        }), $(this).parent().children("li").each(function() {
            $(this).find("input").attr("disabled", "disabled"), $(this).unbind("click")
        });
        var e = $(this).parent().parent().index();
        if ($(this).parent().attr("answer") == $(this).find("input").parent().index()) {
            var t = parseInt($("#item" + currentReadingIndex).find(".en-story").find(".exercise-section-answered").attr("corrected")) + 1;
            $("#item" + currentReadingIndex).find(".en-story").find(".exercise-section-answered").attr("corrected", t), $(".answer-the-questions-section").eq(e).append("<div class=\"answer-voice\">" + $(".answer-key").eq(e).html() + "</div>")
        } else $(".answer-the-questions-section").eq(e).append("<div class=\"answer-voice answer-voice-wrong\">" + $(".answer-key").eq(e).html() + "</div>")
    }), $(".answer-the-questions-section .ul-multi-choose-answer").children("li").each(function() {
        var e = $(this).html();
        $(this).html("<input type=\"checkbox\" name=\"rdo" + $(this).parent().parent().index() + $(this).parent().index() + "\" /> " + e), $(this).css({
            "list-style-type": "none"
        })
    }), $(".answer-the-questions-section .ul-multi-choose-answer").children("li").click(function() {
        $(this).unbind("click");
        var e = parseInt($(this).parent().attr("q")) - 1;
        if (0 <= e && ($(this).parent().attr("q", e), $(this).find("input").attr("checked", "checked"), $(this).css({
                "font-weight": "",
                background: "lightgray",
                padding: "8px"
            }), $(this).find("input").attr("disabled", "disabled"), $(".answer-the-questions-section .ul-multi-choose-answer").children("li").eq($(this).index()).unbind("click")), 0 == e) {
            var t = "";
            if ($(this).parent().children("li").each(function() {
                    $(this).find("input").attr("disabled", "disabled"), $(this).unbind("click"), "checked" == $(this).find("input").attr("checked") && (t += $(this).index() + ",")
                }), 0 < t.length && (t = t.substring(0, t.length - 1)), $(this).parent().parent().attr("answer-index") == t) {
                var i = $("#answer-popup div").eq(0).html().split("/");
                $("#answer-popup div").eq(0).html(parseInt(i[0]) + 1 + "/" + i[1]), $(this).parent().css({
                    background: "#F5F5DC",
                    "border-radius": "7px",
                    padding: "8px",
                    border: "2px solid #1ea362"
                })
            } else {
                var i = $("#answer-popup div").eq(2).html().split("/");
                $("#answer-popup div").eq(2).html(parseInt(i[0]) + 1 + "/" + i[1]), $(this).parent().css({
                    background: "lightgray",
                    "border-radius": "7px",
                    padding: "8px",
                    border: "2px solid red"
                })
            }
        }
    }), $(".faq-list-section .ul-choose-answer li").each(function() {
        var e = $(this).html().replace("_____", " <input class=\"txt-input-answer\" /> ");
        $(this).html(e)
    }), $(".faq-list-section p").each(function() {
        var e = $(this).html().replace(/ __________ /g, " <input class=\"txt-input-answer\" /> ");
        $(this).html(e)
    }), $(".txt-input-one-line").each(function() {
        var e = $(this).html().replace(/ _____ /g, " <input class=\"txt-input-answer\" /> ");
        $(this).html(e)
    }), $(".answer-the-questions-section-char").each(function() {
        var e = $(this).html().replace(/______/g, " <input class=\"txt-input-answer-char\" /> ").replace(/_/g, " <input class=\"txt-input-answer-char\" /> ");
        $(this).html(e)
    }), $(".txt-input-answer-char").bind("input", function() {
        "" !== $(this).val() && $(this).next(".txt-input-answer-char").focus()
    }), $(".answer-the-questions-textarea").each(function() {
        var e = $(this).html().replace(/_____________/g, "<textarea class=\"txt-textarea-long-answer\"></textarea>").replace(/__________/g, "<textarea class=\"txt-textarea-long-answer\"></textarea>");
        $(this).html(e)
    }), $(".answer-the-questions-section-better-fit").each(function() {
        var e = $(this).children("span").eq(0).html().split("/"),
            t = $(this).html().replace(/__________/g, " <select class=\"opt-better-fit\"><option></option></select> ");
        $(this).html(t), $(this).find(".opt-better-fit").each(function() {
            for (var t = 0; t < e.length; t++) $(this).append("<option value=\"" + $.trim(e[t]) + "\">" + $.trim(e[t]) + "</option>")
        })
    }), $(".answer-the-questions-section-word-blank").each(function() {
        var e = $(this).html().replace(/__________/g, "<select class=\"opt-fill-blank\"><option></option></select>");
        $(this).html(e)
    });
    var e = "";
    $("#ul-free-option li").each(function() {
        e += "<option>" + $.trim($(this).html()) + "</option>"
    }), $(".opt-fill-blank").each(function() {
        $(this).append(e)
    });
    var t = "";
    $(".ul-free-option li").each(function() {
        t += "<option>" + $.trim($(this).html()) + "</option>"
    }), 0 < $(".word-blank-cover").length && ("" == t && (t = e), $(".word-blank-cover").find(".answer-the-questions-section-word-blank").each(function() {
        $(this).children(".opt-fill-blank").html("<option></option>"), $(this).children(".opt-fill-blank").append(t)
    })), $(".opt-fill-blank").change(function() {
        $(this).attr("disabled", "disabled"), $(this).css({
            background: "#F3F3F3",
            border: ""
        })
    }), $(".answer-the-questions-section-true-false").each(function() {
        var e = $(this).html().replace(/_____/, "<select class=\"opt-true-false\"><option></option><option>T</option><option>F</option></select>").replace(/__________/, "<textarea class=\"txt-textarea-long-answer\"></textarea>");
        $(this).html(e)
    }), $(".opt-true-false").change(function() {
        $(this).attr("disabled", "disabled"), $(this).css({
            background: "#F3F3F3",
            border: ""
        }), "F" == $(this).val() && $(this).parent().children(".txt-textarea-long-answer").css({
            display: "block"
        })
    }), $(".answer-the-questions-word-similar").each(function() {
        var e = $(this).html().replace(/__________/g, "<input class=\"txt-input-answer\" />");
        $(this).html(e)
    }), $(".answer-the-questions-CI").each(function() {
        var e = $(this).html().replace(/______/, "<select class=\"opt-ci\"><option></option><option>C</option><option>I</option></select>");
        $(this).html(e)
    }), $(".opt-ci").change(function() {
        $(this).attr("disabled", "disabled"), $(this).css({
            background: "#F3F3F3",
            border: ""
        })
    })
}

function resizeTextareaAnswer() {
    $(".txt-textarea-long-answer").css({
        width: ""
    }), 330 > $(window).width() && $(".txt-textarea-long-answer").css({
        width: 230
    })
}

function loadAnswerKey() {
    return ""
}